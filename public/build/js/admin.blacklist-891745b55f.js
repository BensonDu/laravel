(function(){this.w=$(window),this.d=$(document),this.filter=$("#filter"),this.content=$("#admin-content"),this.mid=$("#mid")}).call(define("dom")),function(){window.view_nav_left.fold=function(){return dom.mid.css("left",60),dom.content.css("padding-left",310),dom.filter.addClass("trans").removeClass("unfold")},window.view_nav_left.unfold=function(){return dom.mid.css("left",140),dom.content.css("padding-left",390),dom.filter.addClass("trans").addClass("unfold")}}.call(define("view_page_response")),function(){var e=this;this.model={el:"#admin-content",data:{background:!1,search:{keyword:""},orderby:data.orderby,order:"desc",pagination:{total:data.total,size:10,index:1,btns:[],all:0},list:data.list},methods:{_search:function(){e.page_search()},_size:function(t){e.page_size(t)},_turn:function(t){"number"==typeof t&&e.page_turn(t)},_next:function(){this.pagination.index+1<=this.pagination.all&&e.page_turn(this.pagination.index+1)},_prev:function(){this.pagination.index-1>=1&&e.page_turn(this.pagination.index-1)},_order:function(t){this.orderby=t,this.order="desc"==this.order?"asc":"desc",e.page_order()},_add:function(){controller_pop.display.add()},_del:function(t){pop.confirm("将该用户移出黑名单 ?","确定",function(){e.delete_user(t)})}}},this.page_search=function(){e.get_data()},this.page_order=function(){e.get_data()},this.page_turn=function(t){e.model.data.pagination.index=t,e.get_data()},this.page_size=function(t){var n=e.model.data.pagination;n.size=t,n.all=Math.ceil(n.total/n.size),n.index>n.all&&(n.index=n.all),e.get_data()},this.update_pagination_btn=function(){var t=e.model.data.pagination;return t.all=Math.ceil(t.total/t.size),t.btns=e.create_pagination_btn(t.index,t.size,t.total)},this.create_pagination_btn=function(e,t,n){var a,i,o=Math.ceil(n/t),d=[],r=function(e,t){return d.push({active:e,index:t})},s=function(){return d.push({active:!1,index:"..."})};if(o<=7)for(var c=1;c<=o;c++)r(c==e,c);else{a=e-3<1?1:e-3,i=e+3>o?o:e+3,a>1&&r(!1,1),a>2&&s();for(var c=a;c<=i;c++)r(c==e,c);i<o-1&&s(),i<o&&r(!1,o)}return d},this.get_data=function(){var t=e.model.data;request.get("/admin/user/blacklist/users",function(t){t.hasOwnProperty("code")&&0==t.code&&(e.model.data.pagination.total=t.data.total,e.model.data.list=t.data.list,e.update_pagination_btn())},{index:t.pagination.index,size:t.pagination.size,order:t.order,orderby:t.orderby,keyword:t.search.keyword})},this.delete_user=function(t){request.get("/admin/user/blacklist/del",function(t){t.hasOwnProperty("code")&&0==t.code?e.get_data():pop.error("操作失败","确定")},{id:t})},this.vue=new Vue(e.model),e.update_pagination_btn()}.call(define("controller_admin")),function(){var e=this;this.vue=new Vue({el:"#pop-container",data:{display:"",search:{keyword:"",list:[]}},methods:{_search:function(){e.search()},_close:function(){e.display.hide()},_add:function(t){e.add(t)}}}),this.display={add:function(){e.vue.display="add"},hide:function(){e.vue.display="",e.vue.search.keyword="",e.vue.search.list=[]}},this.search=function(){var t=e.vue.search.keyword;return""!=t&&void request.get("/admin/user/search",function(t){t.hasOwnProperty("code")&&0==t.code?e.vue.search.list=t.data:pop.error("请求错误","确定").one()},{keyword:t})},this.remove=function(t){for(var n=e.vue.search.list,a=n.length,i=[],o=0;o<a;o++)n[o].id&&n[o].id!=t&&i.push(n[o]);e.vue.search.list=i},this.add=function(t){request.get("/admin/user/blacklist/add",function(n){n.hasOwnProperty("code")&&0==n.code?(e.remove(t),controller_admin.get_data()):pop.error("请求错误","确定").one()},{id:t})}}.call(define("controller_pop"));