(function(){this.w=$(window),this.d=$(document),this.filter=$("#filter"),this.content=$("#admin-content"),this.mid=$("#mid")}).call(define("dom")),function(){window.view_nav_left.fold=function(){return dom.mid.css("left",60),dom.content.css("padding-left",310),dom.filter.addClass("trans").removeClass("unfold")},window.view_nav_left.unfold=function(){return dom.mid.css("left",140),dom.content.css("padding-left",390),dom.filter.addClass("trans").addClass("unfold")}}.call(define("view_page_response")),function(){var t=this;this.model={el:"#admin-content",data:{background:!1,search:{keyword:""},order:data.order,pagination:{total:data.total,size:10,index:1,btns:[],all:0},list:data.list},methods:{_search:function(){t.page_search()},_size:function(a){t.page_size(a)},_turn:function(a){"number"==typeof a&&t.page_turn(a)},_next:function(){this.pagination.index+1<=this.pagination.all&&t.page_turn(this.pagination.index+1)},_prev:function(){this.pagination.index-1>=1&&t.page_turn(this.pagination.index-1)},_order:function(a){this.orderby=a,this.order="desc"==this.order?"asc":"desc",t.page_order()},_add:function(){controller_pop.display.add.show()},_open:function(a){var i=this.list[a].id,n="1"==this.list[a].valid?"0":"1";request.get("/admin/site/open",function(i){i.hasOwnProperty("code")&&0==i.code&&(t.model.data.list[a].valid=n)},{id:i,valid:n})}}},this.page_search=function(){t.get_data()},this.page_order=function(){t.get_data()},this.page_turn=function(a){t.model.data.pagination.index=a,t.get_data()},this.page_size=function(a){var i=t.model.data.pagination;i.size=a,i.all=Math.ceil(i.total/i.size),i.index>i.all&&(i.index=i.all),t.get_data()},this.update_pagination_btn=function(){var a=t.model.data.pagination;return a.all=Math.ceil(a.total/a.size),a.btns=t.create_pagination_btn(a.index,a.size,a.total)},this.create_pagination_btn=function(t,a,i){var n,d,e=Math.ceil(i/a),o=[],s=function(t,a){return o.push({active:t,index:a})},r=function(){return o.push({active:!1,index:"..."})};if(e<=7)for(var l=1;l<=e;l++)s(l==t,l);else{n=t-3<1?1:t-3,d=t+3>e?e:t+3,n>1&&s(!1,1),n>2&&r();for(var l=n;l<=d;l++)s(l==t,l);d<e-1&&r(),d<e&&s(!1,e)}return o},this.get_data=function(){var a=t.model.data;request.get("/admin/site/list",function(a){a.hasOwnProperty("code")&&0==a.code&&(t.model.data.pagination.total=a.data.total,t.model.data.list=a.data.list,t.update_pagination_btn())},{index:a.pagination.index,size:a.pagination.size,order:a.order,keyword:a.search.keyword})},this.vue=new Vue(t.model),t.update_pagination_btn()}.call(define("controller_admin")),function(){var t=this;this.vue=new Vue({el:"#pop-container",data:{display:"",add:{name:"",platform:!0,domain:"",base:data.platform.domain,icp:data.icp}},methods:{_close:function(){t.display.add.hide()},_switch:function(){this.add.platform=!this.add.platform,this.add.domain="",this.add.icp=this.add.platform?data.icp:""},_confirm_add:function(){t.add_site()}}}),this.display={add:{show:function(){t.vue.display="add",controller_admin.model.data.background=!0},hide:function(){t.vue.display="",t.vue.add.domain="",t.vue.add.icp=data.icp,t.vue.add.platform=!0,t.vue.add.name="",controller_admin.model.data.background=!1}}},this.add_site=function(){var a=t.vue.add,i=a.platform?"http://"+a.domain+"."+data.platform.domain+"/admin/site":"http://"+a.domain+"/admin/site";request.post("/admin/site/add",function(a){a.hasOwnProperty("code")&&0==a.code?(t.update_list(),t.display.add.hide(),window.open(i,"_blank")):pop.error(a.msg||"添加站点失败","确定").one()},{platform:a.platform?"true":"false",name:a.name,domain:a.domain,icp:a.icp})},this.update_list=function(){controller_admin.get_data()}}.call(define("controller_pop"));